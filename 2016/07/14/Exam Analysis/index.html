<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>  · Hexo of Tilly Vally @ GitHub</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/jekyll.css"><!--[if lt IE 9]>
<script src="js/html5shiv.min.js"></script>
<script src="js/respond.min.js"></script>
<![endif]--></head><body><header class="row-flex-row limit-width vh-center"><a href="/" class="logo"><img src="/favicon.png"></a><nav><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-link">主页</a></li><li class="nav-list-item"><a href="/archives/" class="nav-link active">   博客</a></li><li class="nav-list-item"><a href="/atom.xml" class="nav-link">rss</a></li><li class="nav-list-item"><a href="https://github.com/xxxxx" target="_blank" class="nav-link">   github</a></li></ul></nav></header><div class="container limit-width"><section class="row-flex-row"><div class="post"><article class="post-block"><h2 class="post-title"><a href="/2016/07/14/Exam Analysis/" class="post-title-link"></a></h2><div class="post-meta"><div class="post-time">星期五, 七月 15日 2016</div></div><div class="post-content"><h1 id="EXAM_u7A0B_u5E8F_u5206_u6790"><a href="#EXAM_u7A0B_u5E8F_u5206_u6790" class="headerlink" title="EXAM程序分析"></a>EXAM程序分析</h1><h2 id="u5DE6_u8FB9_u6ED1_u52A8Menu"><a href="#u5DE6_u8FB9_u6ED1_u52A8Menu" class="headerlink" title="左边滑动Menu"></a>左边滑动Menu</h2><h3 id="u5206_u6790"><a href="#u5206_u6790" class="headerlink" title="分析"></a>分析</h3><ul>
<li><p>main.jsp: 加载创建左边菜单</p>
  <figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;ctx&#125;/athrtyConfig.<span class="keyword">do</span>?<span class="keyword">method</span>=getMenuTree</span><br></pre></td></tr></table></figure>
</li>
<li><p>AthrtyController.java: 对应athrtyConfig.do, getMenuTree方法</p>
  <figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">JSONArray</span> jSONArray = athrtyService.findUserAthrtyTree(<span class="built_in">map</span>);</span><br></pre></td></tr></table></figure>
<p>  <code>findUserAthrtyTree(map);</code>对应batis mapper中的映射关系</p>
</li>
<li><p>AthrtyMapper.xml: 对应java文件的数据查询<br>  <code>id</code>为<code>findUserAthrtyTree</code>对应查询用户树形Menu数据</p>
<p>  返回类型为athrtyResult:</p>
  <figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap id=<span class="string">"athrtyResult"</span> <span class="keyword">type</span>=<span class="string">"com.admin.exam.business.domain.sys.AthrtyEntity"</span>&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"authId"</span> column=<span class="string">"AUTH_ID"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"authName"</span> column=<span class="string">"AUTH_NAME"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"disType"</span> column=<span class="string">"DIS_TYPE"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"authDesc"</span> column=<span class="string">"AUTH_DESC"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"authType"</span> column=<span class="string">"AUTH_TYPE"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"pauthId"</span> column=<span class="string">"PAUTH_ID"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"authUrl"</span> column=<span class="string">"AUTH_URL"</span> /&gt;</span><br><span class="line">    &lt;<span class="literal">result</span> property=<span class="string">"orderLevel"</span> column=<span class="string">"ORDER_LEVEL"</span> /&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br></pre></td></tr></table></figure>
<p>  返回结果：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"系统管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"系统管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"A"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>,"<span class="attribute">state</span>":<span class="value"><span class="string">"open"</span></span>,"<span class="attribute">children</span>":<span class="value">[&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">101</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"用户管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">101</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"用户管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"mngUserInfo.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">102</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"角色管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">102</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"角色管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"roleConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">103</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"权限管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">103</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"权限管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"athrtyConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;]</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考试管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考试管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"A"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>,"<span class="attribute">state</span>":<span class="value"><span class="string">"open"</span></span>,"<span class="attribute">children</span>":<span class="value">[&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">201</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"试题管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">201</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"试题管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"questionConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">202</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"科目管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">202</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"科目管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"subjectConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">203</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考务管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">203</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考务管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"examConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;]</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"数据管理"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"数据管理"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"A"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>,"<span class="attribute">state</span>":<span class="value"><span class="string">"open"</span></span>,"<span class="attribute">children</span>":<span class="value">[&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">301</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"知识点配置"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">301</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"知识点配置"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"knowledgeConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">302</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"岗位配置"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">302</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"岗位配置"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"postConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">303</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"岗位科目配置"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">303</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"岗位科目配置"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"postSubjectConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">304</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考试等级配置"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">304</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考试等级配置"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"ScoreConfig.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;]</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"统计分析"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"统计分析"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"A"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>,"<span class="attribute">state</span>":<span class="value"><span class="string">"open"</span></span>,"<span class="attribute">children</span>":<span class="value">[&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">401</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"知识点统计"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">401</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"知识点统计"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"stsKnowledge.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">402</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考核统计"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">402</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考核统计"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"stsExam.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">403</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考试明细"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">403</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考试明细"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"stsUserExamInfo.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">3</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">4</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;]</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">5</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考试信息"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">5</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考试信息"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"A"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">5</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>,"<span class="attribute">state</span>":<span class="value"><span class="string">"open"</span></span>,"<span class="attribute">children</span>":<span class="value">[&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">501</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"用户考试信息"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">501</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"用户考试信息"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"userExamInfo.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">1</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">5</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;,&#123;"<span class="attribute">id</span>":<span class="value"><span class="number">502</span></span>,"<span class="attribute">text</span>":<span class="value"><span class="string">"考试监控"</span></span>,"<span class="attribute">attributes</span>":<span class="value">&#123;"<span class="attribute">authDesc</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authId</span>":<span class="value"><span class="number">502</span></span>,"<span class="attribute">authName</span>":<span class="value"><span class="string">"考试监控"</span></span>,"<span class="attribute">authType</span>":<span class="value"><span class="string">""</span></span>,"<span class="attribute">authUrl</span>":<span class="value"><span class="string">"ExamMonitor.do"</span></span>,"<span class="attribute">disType</span>":<span class="value"><span class="string">"C"</span></span>,"<span class="attribute">orderLevel</span>":<span class="value"><span class="number">2</span></span>,"<span class="attribute">pauthId</span>":<span class="value"><span class="number">5</span></span>,"<span class="attribute">resId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">roleId</span>":<span class="value"><span class="number">0</span></span>,"<span class="attribute">userId</span>":<span class="value"><span class="string">""</span></span>&#125;</span>&#125;]</span>&#125;]</span><br></pre></td></tr></table></figure>
</li>
<li><p>数据库表：MG_ATHRTY_INFO</p>
</li>
<li>SQL 操作<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">select</span> AUTH_ID,AUTH_NAME,DIS_TYPE,AUTH_DESC,AUTH_TYPE,PAUTH_ID,AUTH_URL,ORDER_LEVEL <span class="keyword">from</span> MG_ATHRTY_INFO <span class="keyword">where</span> </span><br><span class="line">    AUTH_ID <span class="keyword">in</span> (<span class="keyword">select</span> AUTH_ID <span class="keyword">from</span> MG_ROLE_ATHRTY <span class="keyword">where</span> ROLE_ID <span class="keyword">in</span> (<span class="keyword">select</span> ROLE_ID <span class="keyword">from</span> MG_USERROLE_REL <span class="keyword">where</span> USER_ID=#&#123;userId&#125;)) <span class="keyword">AND</span> <span class="keyword">substring</span>(AUTH_ID,<span class="number">1</span>,<span class="number">1</span>) &lt;![CDATA[ &lt;&gt; ]]&gt; <span class="number">6</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>组合条件:</p>
<ol>
<li><p><code>select ROLE_ID from MG_USERROLE_REL where USER_ID=#{userId}</code> :从<code>MG_USERROLE_REL</code>中选择被查询用户（userId）的角色ID（ROLE_ID）</p>
</li>
<li><p><code>select AUTH_ID from MG_ROLE_ATHRTY where ROLE_ID in</code>: 从<code>MG_ROLE_ATHRTY</code>中选择<code>ROLE_ID</code>在上面结果集中的<code>AUTH_ID</code></p>
</li>
<li><p>从<code>MG_ATHRTY_INFO</code>中选择 在上面结果集中的<code>AUTH_ID</code></p>
</li>
<li><p>并且<code>substring(AUTH_ID,1,1) != 6</code>: 函数SUBSTRING (expression,start,length), 过滤AUTH_ID为<code>60x</code>的普通用户菜单.</p>
</li>
</ol>
<h3 id="u6DFB_u52A0_u83DC_u5355_u9879_u6B65_u9AA4"><a href="#u6DFB_u52A0_u83DC_u5355_u9879_u6B65_u9AA4" class="headerlink" title="添加菜单项步骤"></a>添加菜单项步骤</h3><ol>
<li><p>MG_ATHRTY_INFO表中添加对应菜单项,AUTH_URL为调用的页面地址</p>
</li>
<li><p>MG_ROLE_ATHRTY中添加对应权限</p>
</li>
</ol>
<h2 id="u4E1A_u52A1_u6D41_u7A0B_u6DFB_u52A0"><a href="#u4E1A_u52A1_u6D41_u7A0B_u6DFB_u52A0" class="headerlink" title="业务流程添加"></a>业务流程添加</h2><p>如上,如果增加了一个新菜单项,该菜单项对应一个新业务页面,业务流程的添加步骤如下:</p>
<ol>
<li><p>新增jsp文件,用于前台页面</p>
</li>
<li><p>新增XxxController.java控制类<br>Xxx与上面的AUTH_URL中的数据对应,例如,如果URL为<code>xyzAbcdef.do</code>,那么控制类的文件名对应为<code>XyzAbcdefController.java</code>,注意控制类首字母要大写.<br>应<code>import</code>对应的Entity和Service文件.</p>
<p>在Controller文件中增加请求映射:</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="annotation">@RequestMapping</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">String <span class="title">management</span><span class="params">(ModelMap mMap, HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"your_new_file_directory/xxxxxx"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样点击菜单项时,自动映射调用对应的jsp文件, 注意xxxxxx为不带后缀名的文件名.</p>
</li>
</ol>
<ol>
<li><p>新增XxxService.java服务类<br>规则与控制类相同.应<code>import</code>对应的Entity和Dao文件.</p>
</li>
<li><p>新增XxxMapper.xml映射文件<br>规则与控制类相同.</p>
</li>
<li><p>新增XxxEntity.java实体文件<br>规则与控制类相同. Entity文件设置私有属性及其对应的set和get接口方法.</p>
</li>
<li><p>新增XxxDao.java数据模型文件<br>规则与控制类相同. Dao与Mapper对应, 应<code>import</code>对应的Entity文件.</p>
</li>
</ol>
<h2 id="u6587_u4EF6_u8DEF_u5F84_u903B_u8F91"><a href="#u6587_u4EF6_u8DEF_u5F84_u903B_u8F91" class="headerlink" title="文件路径逻辑"></a>文件路径逻辑</h2><h3 id="java_u6587_u4EF6"><a href="#java_u6587_u4EF6" class="headerlink" title="java文件"></a>java文件</h3><ul>
<li>com.admin.exam.web.xxx : 控制类文件路径</li>
<li>com.admin.exam.business.service.xxx: 服务类文件路径</li>
</ul>
</div></article><div class="pagination"><a href="/2016/07/14/Table Layout in CSS/" class="pagination-prev">PREV</a><a href="/2016/06/27/JQuery EasyUI Sourece Code Analysis/" class="pagination-next">NEXT</a></div></div><aside class="sidebar"><h3>分类标签</h3><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/">Angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Browserify/">Browserify</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Callback/">Callback</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Closure/">Closure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Event/">Event</a></li></ul><h3>最新文章</h3><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/07/14/Table Layout in CSS/">Table Layout in CSS</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/14/Exam Analysis/">Exam Analysis</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/27/JQuery EasyUI Sourece Code Analysis/">JQuery EasyUI Sourece Code Analysis</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/25/AngularJS/">Angular</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/23/demystifying-javascript-closures-callbacks-iifes/">demystifying-javascript-closures-callbacks-iifes</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/01/Browserify/">Browserify</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/26/strict-mode/">strict mode</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/26/Try{} and Catch{}/">Try{} and Catch{}</a></li></ul></aside></section></div><div class="extra"></div><footer class="footer"><div class="row-flex-row limit-width vh-center"><div class="copyright"><P>© 2016 <a href="/">Tilly Vally</P></div><div class="power"><p><a href="http://pinggod.com/">Sean Sun</a>, 
<a href="https://hexo.io">Hexo</a>, 
<a href="https://github.com/">GitHub</a>, 
<a href="https://jekyllrb.com/">Jekyll</a></p></div></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>